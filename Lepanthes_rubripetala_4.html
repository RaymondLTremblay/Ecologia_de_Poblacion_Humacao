<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="BIOL4558" />


<title>Lepanthes rubripetala</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> BIOL4458</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Calendario</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Conferencias
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introducción a BIOL4458</a>
    </li>
    <li>
      <a href="LECTURE1_2.html">Un enfoque de sistemas holístico</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introducción a la Ecología de Poblaciones</a>
    </li>
    <li>
      <a href="LECTURE3_2.html">Thomas Robert Malthus</a>
    </li>
    <li>
      <a href="LECTURE4.html">Regulación de Poblaciones</a>
    </li>
    <li>
      <a href="LECTURE5.html">Paloma Viajera</a>
    </li>
    <li>
      <a href="LECTURE6.html">Población estructurada por Edad</a>
    </li>
    <li>
      <a href="LECTURE6a.html">Dinamica Poblacional en Orquideas</a>
    </li>
    <li>
      <a href="LECTURE7.html">Modelos de población usando Matrices</a>
    </li>
    <li>
      <a href="Lepanthes_rubripetala_4.html">Modelos matriciales de una orquidea</a>
    </li>
    <li>
      <a href="LECTURE8.html">Modelos Estochasticos de poblaciones</a>
    </li>
    <li>
      <a href="LECTURE9.html">El paradigma de pequeñas poblaciones</a>
    </li>
    <li>
      <a href="LECTURE10.html">Modelos individuales</a>
    </li>
    <li>
      <a href="LECTURE11.html">El paradigma de poblaciones en reducción</a>
    </li>
    <li>
      <a href="LECTURE12.html">PVA = Population Viability Analysis</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="LECTURE15.html">Estimados de parametros</a>
    </li>
    <li>
      <a href="LECTURE16.html">Interaciones entre especies: competencia</a>
    </li>
    <li>
      <a href="LECTURE17.html">Interaciones entre especies: presa-depredador</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tareas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Tarea_1_historia_vida.html">Tarea 1: Historia de Vida</a>
    </li>
    <li>
      <a href="Tarea_Ballena.html">Tarea 2: Dinámica de Ballenas</a>
    </li>
    <li>
      <a href="Tarea_3_Paradigma_Poblacion_declive.html">Tarea 3: Paradigma de población en declive</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Proyecto Final</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Invitados
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Invitados.html">Lecturas de los Invitados</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Ejemplos de proyecto de PVA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="PVA_Ejemplos.html">PVA por los estudiantes</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lepanthes rubripetala</h1>
<h4 class="author">BIOL4558</h4>
<h4 class="date">Agosto 2021</h4>

</div>


<div id="appendix-s1" class="section level3">
<h3>APPENDIX S1</h3>
<ul>
<li>R code for figures</li>
<li>This appendix provides R code for producing the figures included in
the main manuscript.</li>
<li>Install the library using install.packages() or by downloading from
<a href="http://cran.R-project.org"
class="uri">http://cran.R-project.org</a></li>
</ul>
</div>
<div id="load-the-library" class="section level3">
<h3>Load the library</h3>
<pre class="r"><code>library(popdemo)
library(popbio)</code></pre>
<p><em>Lepanthes</em> is one of the largest genera of the Orchidaceae
with &gt;1200 species, found only in the Neotropics.</p>
<hr />
<p>Here is photo of the flower of <em>Lepanthes rubripetala</em>,</p>
<div class="figure">
<img src="figures/Lepanthes_rubripetala.png" alt="" />
<p class="caption">Lepanthes rubripetala</p>
</div>
<p>A population of <em>Lepanthes rupestris</em>, those of <em>Lepanthes
rubripetala</em> growth in the same way (on rocks or trees), so these
groups of individuals are discrete and may be seperated by large
distances.</p>
<hr />
<div class="figure">
<img
src="figures/Lepanthes-rupestris-on-a-boulder-along-Quebrada-Sonadora-in-the-Caribbean-National.png"
alt="" />
<p class="caption">Lepanthes population</p>
</div>
<hr />
</div>
<div id="lectura-para-lunes" class="section level2">
<h2>Lectura para Lunes</h2>
<p>Deben leer el siguiente manuscrito para lunes, habrá prueba corta
sobre este manuscrito.</p>
<p><a
href="PDF/When%20stable-stage%20equilibrium%20is%20unlikely-%20integrating%20transient%20population%20dynsmics.pdf">Tremblay,
Raventos Ackerman</a>. Habrá un quiz de comprobación de lectura al
principio de la clase.</p>
<hr />
</div>
<div id="lepanthes-rubripetala-population-3" class="section level1">
<h1>Lepanthes rubripetala population #3</h1>
<div id="how-to-construct-a-matrix-in-r" class="section level3">
<h3>How to construct a matrix in R</h3>
<pre class="r"><code> R3=matrix(c(
0.43,   0,      0,   0.14,
0.38,   0.84,   0,  0, 
0,      0,      0.51,   0.15,   
0,      0.14,    0.43, 0.84
), byrow=TRUE, ncol=4)

Lrub1=R3

Lrub1</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.14
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.14 0.43 0.84</code></pre>
</div>
<div id="two-problems-need-to-be-evaluated-before-analysis"
class="section level2">
<h2>Two problems need to be evaluated before analysis</h2>
<ul>
<li><p><strong>Ergodicity</strong> (the condition that regardless of the
initial stage structure, the asymptotic growth rate will be the
same)</p></li>
<li><p><strong>Irreducibility</strong> (the condition that the
transitions from all stages to all other stages are possible),</p></li>
</ul>
<p>failure to meet both of these conditions which may severely impact
matrix structure and analyses (Stott et al., 2010a).</p>
<p>You can test this with the following functions from “popdemo”.</p>
<pre class="r"><code>isErgodic(Lrub1, digits=10, return.eigvec=FALSE)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>isIrreducible(Lrub1)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>lambda(Lrub1)</p>
<hr />
<p>Here is the theoretical life cycle of the species</p>
<div class="figure">
<img src="figures/Fig_theoretical_Life_cycle.png" alt="" />
<p class="caption">Theoretical life cycle</p>
</div>
</div>
<div id="reality-of-the-data-collection" class="section level2">
<h2>Reality of the data collection</h2>
<p>However the data from this matrix is limited because seeds and fungy
infection cannot be evaluated in the field, because seeds are too small
and there is no quick technique in the field to detedct the symbiotic
fungi.</p>
<p>This matrix is size-based, with medium fecundity. The size classes
are as follows: - 1: Plantula - 2: Juveniles - 3: A0: non-reproductive
adults - 4: A+: reproductive adults</p>
<div id="section" class="section level75">
<p class="heading"></p>
<p>#FIGURE 1: POPULATION PROJECTION #</p>
<p>#This figure is designed to be 3.5” by 3.5” #(Check size of plot
window using ‘par(din)’). # # #Set margins: par(mar=c(5,4,1,1))</p>
<p>#Create a population vector. This one is biased towards adults.</p>
<pre class="r"><code>n0 &lt;- c(0, 0, 2, 0)</code></pre>
</div>
</div>
<div id="now-project-the-population-for-x-years-in-the-future."
class="section level2">
<h2>Now project the population for x years in the future.</h2>
<p>Project the orchid PPM and population vector. In this case, we are
projecting for 24 time intervals. The orchid interval is one month, so
this projection is for 2 years. We use the function ‘project’.</p>
<pre class="r"><code>pr1 &lt;- project(Lrub1, vector=n0, time=24)

#Plot the projection. This uses an S3 plotting
#method for projections. For info, see &#39;?plot.projection&#39;.  
plot(pr1)</code></pre>
<p><img src="Lepanthes_rubripetala_4_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="primitive-matrix" class="section level2">
<h2>Primitive Matrix</h2>
<p>For a primitive matrix (see below), the long-term growth rate is the
real part of the first dominant eigenvalue of the PPM.</p>
<pre class="r"><code>eigs &lt;- eigen(Lrub1)
eigs</code></pre>
<pre><code>## eigen() decomposition
## $values
## [1] 1.0296288+0.000000i 0.7709252+0.000000i 0.4097230+0.050035i
## [4] 0.4097230-0.050035i
## 
## $vectors
##              [,1]          [,2]                  [,3]                  [,4]
## [1,] 0.2004457+0i -0.1598129+0i  0.6765605+0.0000000i  0.6765605+0.0000000i
## [2,] 0.4016762+0i  0.8791759+0i -0.5895339-0.0685543i -0.5895339+0.0685543i
## [3,] 0.2478274+0i -0.2237269+0i  0.2618588-0.2310360i  0.2618588+0.2310360i
## [4,] 0.8585216+0i -0.3891732+0i -0.0979901+0.2417980i -0.0979901-0.2417980i</code></pre>
<pre class="r"><code>lambdamax &lt;- Re(eigs$values[1])
lambdamax</code></pre>
<pre><code>## [1] 1.029629</code></pre>
<p>Stable Stable Stage distribution</p>
<p>The stable demographic structure of the population is equal to the
dominant right eigenvector, which is the absolute value of the real part
of the first eigenvector.</p>
<p>This is the expected proportional distribution among the different
stages <strong>IF</strong> the population attains a sable structure.</p>
<pre class="r"><code>w &lt;- stable.stage(Lrub1)
w</code></pre>
<pre><code>## [1] 0.1173246 0.2351086 0.1450580 0.5025088</code></pre>
<p>Note that the package popbio provides functions ‘lambda’ and
‘stable.stage’ that will provide these also.</p>
<p>For more info on projecting population dynamics, see
demo(projection).</p>
<hr />
<div id="section-1" class="section level75">
<p class="heading"></p>
</div>
</div>
<div id="transient-dynamics" class="section level2">
<h2>TRANSIENT DYNAMICS</h2>
<hr />
</div>
</div>
<div id="section-2" class="section level1">
<h1></h1>
<p>Fig. 2a: Population-specific transient dynamics # This figure is
designed to be 3.5” by 3.5” (Check size of plot window using
‘par(din)’).</p>
<p>Set margins: par(mar=c(10,4,1,1))</p>
<p>Create 2 population vectors. One is adult- biased, and it amplifies.
One is juvenile- biased and it attenuates.</p>
<p>n0.amp &lt;- c(1000,1,1,1)</p>
<p>n0.att &lt;- c(1,1,1,1000)</p>
<p>Project these vectors using the project function. We are
standardising the matrix using ‘standard.A=T’ to remove effects of
asymptotic dynamics. This means that the projection has a long-term
growth rate of unity, i.e. it does not grow or decline in the long-term.
We also standardise the population vector to sum to 1 using
‘standard.vec=T’. These standardisations make it easier (and fairer) to
compare between models with different population sizes, and different
long-term growth rates. pr2.1 &lt;- project(Lrub1, vector=n0.amp,
time=156, standard.A=T, standard.vec=T) pr2.2 &lt;- project(Lrub1,
vector=n0.att, time=156, standard.A=T, standard.vec=T)</p>
<p>Plot the amplification projection and label it plot(pr2.1,
ylim=c(0.4,1), log=“y”, cex.axis=0.8) text(52, pr2.1[51],
“amplification”, adj=c(1,-0.5), cex=0.8) maxamp(Lrub1, vector=n0.amp)
reactivity(Lrub1,vector=n0.amp) inertia(Lrub1,vector=n0.amp)</p>
<p>Calculate the transient dynamics of the amplification projection reac
&lt;- reactivity(Lrub1, vector=n0.amp) maxamp &lt;- maxamp(Lrub1,
vector=n0.amp, return.t=T) upinertia &lt;- inertia(Lrub1,
vector=n0.amp)</p>
<p>Add points on the projection for amplification and label them
points(c(1,maxamp<span class="math inline">\(t,31),
c(reac,maxamp\)</span>maxamp,upinertia), pch=3, col=“red”) text(1, reac,
expression(bar(P)[1]), adj=c(-0.3,0.5), col=“red”, cex=0.8)
text(maxamp<span class="math inline">\(t, maxamp\)</span>maxamp,
expression(bar(P)[max]), adj=c(0.1,-0.5), col=“red”, cex=0.8) text(31,
upinertia, expression(bar(P)[infinity]), adj=c(0.1,-0.5), col=“red”,
cex=0.8)</p>
<p>Add in the second projection using the ‘lines’ command and label it
lines(0:50, pr2.2) text(52, pr2.2[51], “attenuation”, adj=c(1,1),
cex=0.8)</p>
<p>Calculate the transient dynamics of the attenuation projection
firstep &lt;- firststepatt(Lrub1, vector=n0.att) maxatt &lt;-
maxatt(Lrub1, vector=n0.att, return.t=T) lowinertia &lt;- inertia(Lrub1,
vector=n0.att)</p>
<p>firststepatt(Lrub1, vector=n0.att) maxatt(Lrub1, vector=n0.att,
return.t=T) inertia(Lrub1, vector=n0.att)</p>
<p>Add points on the attenuation projection and label them
points(c(1,maxatt<span class="math inline">\(t,31),
c(firstep,maxatt\)</span>maxatt,lowinertia), pch=3, col=“red”) text(1,
firstep, expression(underline(P)[1]), adj=c(0,-0.6), col=“red”, cex=0.8)
text(maxatt<span class="math inline">\(t, maxatt\)</span>maxatt,
expression(underline(P)[min]), adj=c(0.1,1.5), col=“red”, cex=0.8)
text(31, lowinertia, expression(underline(P)[infinity]), adj=c(0.1,1.5),
col=“red”, cex=0.8)</p>
<p>Add in a dotted line at y=1 lines(c(0,50),c(1,1),lty=2)</p>
<hr />
<p>Fig. 2b: Transient bounds This figure is designed to be 3.5” by 3.5”
(Check size of plot window using ‘par(din)’).</p>
<p>Set margins: par(mar=c(5,4,1,1))</p>
<p>Transient bounds result from projections of the stage-biased dynamics
of the model. When using the function ‘project’, the stage-biased model
dynamics are projected automatically if no population vector is
specified. We can do this for the orchid, using a standardised matrix
like before: pr2 &lt;- project(Lrub1, standard.A=TRUE, time=156)</p>
<p>Now we need to plot these population dynamics. The S3 method for
projections automatically plots all stage-biased projections: plot(pr2,
log=“y”, cex.axis=0.8, ylim=c(0.4,1.5))</p>
<p>Add in a dotted line at y=1 lines(c(0,156), c(1,1), lty=2)</p>
<p>Calculate the bounds on transient dynamics for the orchid. This is
also done automatically if no population vector is specified. reacb
&lt;- reactivity(Lrub1) firstepb &lt;- firststepatt(Lrub1) maxampb &lt;-
maxamp(Lrub1, return.t=T) maxattb &lt;- maxatt(Lrub1, return.t=T)
upinertiab &lt;- inertia(Lrub1, bound=“upper”) lowinertiab &lt;-
inertia(Lrub1, bound=“lower”)</p>
<p>reactivity(Lrub1) firststepatt(Lrub1) maxamp(Lrub1, return.t=T)
maxatt(Lrub1, return.t=T) inertia(Lrub1, bound=“upper”) inertia(Lrub1,
bound=“lower”)</p>
<p>Add points on the projection and label them points(c(1,1,maxampb<span
class="math inline">\(t,maxattb\)</span>t,31,31),
c(reacb,firstepb,maxampb<span
class="math inline">\(maxamp,maxattb\)</span>maxatt,upinertiab,lowinertiab),
pch=3,col=“red”) text(1, reacb, expression(bar(rho)[1]),
adj=c(-0.5,0.5), col=“red”, cex=0.8) text(1, firstepb,
expression(underline(rho)[1]), adj=c(-0.5,1.5), col=“red”, cex=0.8)
text(maxampb<span class="math inline">\(t, maxampb\)</span>maxamp,
expression(bar(rho)[max]), adj=c(0.1,-0.5), col=“red”, cex=0.8)
text(maxattb<span class="math inline">\(t, maxattb\)</span>maxatt,
expression(underline(rho)[min]), adj=c(0.1,1.5), col=“red”, cex=0.8)
text(31, upinertiab, expression(bar(rho)[infinity]), adj=c(0.1,-0.5),
col=“red”, cex=0.8) text(31, lowinertiab,
expression(underline(rho)[infinity]), adj=c(0.1,1.5), col=“red”,
cex=0.8)</p>
<p>Amplification bounds result from the projection of a population with
100% stage x individuals. Attenuation bounds result from the projection
of a population with 100% stage 1 individuals.</p>
<div id="section-3" class="section level70">
<p class="heading"></p>
<p>FIGURE 3: TRANSFER FUNCTIONS</p>
<hr />
<p>Fig. 3a: Transfer function of asymptotic growth</p>
<p>This figure is designed to be 3.5” by 3.5” (Check size of plot window
using ‘par(din)’).</p>
<p>Set margins: par(mar=c(5,4,1,1))</p>
<p>Create a transfer function using ‘tfa’. The perturbation structure is
determined by two vectors d and e. The matrix d%*%t(e) gives the
structure, where nonzero elements in this matrix are the elements of the
PPM to be perturbed. The relative size of entries in this matrix are the
relative sizes of perturbation to those elements. In this case, we are
perturbing element [5,4]. We are going to look at the effect of
perturbing up to 0.25. The largest biologically reasonable perturbation
is about 0.12. tf1 &lt;- tfa(Lrub1, d=c(1,0,0,0), e=c(0,0,1,0),
prange=seq(0,0.25,0.01))</p>
<p>Now we plot this using an S3 method for transfer functions (for
information see ‘?plot.tfa’). plot(tf1, cex.axis=0.8)</p>
<p>Now we’re going to add in the sensitivity tangent. This has an
intercept of lambda-max, and a slope of the sensitivity of the same
transfer function. Calculate lambda-max of the desert tortoise PPM:
lambda &lt;- Re(eigen(LaeliaZ1)$values[1])</p>
<p>Calculate the sensitivity using the function ‘tfsens’: sens1 &lt;-
tfsens(Lrub1, d=c(0,0,0,1), e=c(0,0,1,0))</p>
<p>Now add in the line, specifying the correct intercept and slope:
abline(lambda, sens1, lty=2, col=“red”)</p>
<hr />
<p>Fig. 3b: Transfer function of population inertia</p>
<p>This figure is designed to be 3.5” by 3.5” (Check size of plot window
using ‘par(din)’).</p>
<p>Set margins: par(mar=c(5,4,1,1))</p>
<p>The process is very similar to above. We need to specify a PPM,
perturbation structure and perturbation range. For inertia we either
have to specify a population vector using the ‘vector’ argument, or the
bound to be calculated using the ‘bound’ argument. Create a population
vector: n0 &lt;- c(1,8,13,21)</p>
<p>tf1 &lt;- tfa(Lrub1, d=c(0,0,0,1), e=c(0,0,1,0),
prange=seq(0,0.25,0.01))</p>
<p>Now calculate the transfer function using inertia.tfa: tf2 &lt;-
inertia.tfa(Lrub1, vector=n0, d=c(0,0,0,1), e=c(0,0,1,0), prange=
seq(0,0.25,0.01))</p>
<p>Plot the transfer function using the same S3 method as before:
plot(tf2, cex.axis=0.8, ylim=c(3.9,4.43))</p>
<p>The sensitivity tangent for transfer function of inertia has an
intercept of equal to the relevant inertia (either using the same
population vector, or the correct bound), and a slope of the sensitivity
of the same transfer function. Calculate inertia of the desert tortoise
PPM using the population vector: inertia &lt;- inertia(Lrub1,
vector=n0)</p>
<p>Calculate the sensitivity using the function ‘inertia.tfsens’: sens2
&lt;- inertia.tfsens(Lrub1, vector=n0, d=c(0,0,0,1), e=c(0,0,1,0),
tolerance=1e-5)</p>
<p>(Here the ‘tolerance’ has had to be lowered to avoid calculation
error: try the function without that argument and it will have trouble
running)</p>
<p>Now add in the line, specifying the correct intercept and slope:
abline(inertia, sens2, lty=2, col=“red”)</p>
<div id="section-4" class="section level73">
<p class="heading"></p>
<p>FIGURE 4: TRANSFER FUNCTION MATRIX</p>
<p>This figure is designed to be 7” by 7” (Check size of plot window
using ‘par(din)’).</p>
<p>This is a nice, easy plot because the function does it all for you.
The functions ‘tfmat’ and ‘inertia.tfmat’ calculate a transfer function
for every PPM element. They are saved as arrays of values. The functions
are customisable: see ‘?tfmat’ and ‘?inertia.tfmat’.</p>
<p>Create the array for inertia, using a specific population vector: n0
&lt;- c(48, 16, 12, 10) tfmat &lt;- inertia.tfamatrix(Lrub1,
vector=n0)</p>
<p>…and plot it! plot(tfmat)</p>
<p>n0 &lt;- c(48, 16, 12, 10) tfmat &lt;- tfamatrix(Lrub1)</p>
<p>…and plot it! plot(tfmat)</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
